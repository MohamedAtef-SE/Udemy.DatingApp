import{a as G}from"./chunk-OKKMBZFP.js";import{f as B}from"./chunk-I5PP4UYU.js";import{a as E}from"./chunk-L3R4MWKK.js";import"./chunk-XAZLOLJU.js";import{$a as y,Ba as w,Da as I,Ea as P,Fa as U,Ga as k,Ha as r,Ia as i,J as H,Ja as p,Jb as z,M as j,N as _,Na as v,P as c,Pa as d,Qa as u,W as h,Wa as Q,X as x,Xa as W,Y as D,Ya as L,Z as V,_a as s,da as $,gb as f,hb as T,la as a,va as g,xa as C,za as b}from"./chunk-R4PBEABJ.js";import{a as A,b as F}from"./chunk-5WK33CEB.js";var S=(()=>{class t{constructor(e){this._HttpClient=e}getUsersWithRoles(){return this._HttpClient.get(`${E.baseURL}/admin/users-with-roles`)}updateUserRoles(e,n){return this._HttpClient.post(`${E.baseURL}/admin/edit/roles/${e}?roles=${n}`,{})}static{this.\u0275fac=function(n){return new(n||t)(j(z))}}static{this.\u0275prov=H({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function N(t,m){if(t&1){let e=v();r(0,"div",10)(1,"input",14),d("change",function(){let o=h(e).$implicit,l=u();return x(l.updateChecked(o))}),i(),r(2,"label",15),s(3),i()()}if(t&2){let e=m.$implicit,n=u();a(),b("id",e)("checked",n.selectedRoles().includes(e))("disabled",e==="Admin"&&n.username==="admin"),a(),b("for",e),a(),y(e)}}var M=(()=>{class t{constructor(){this._AccountService=_(B),this._AdminService=_(S),this.User=g({}),this.username="",this.hideModal=!0,this.title="",this.availableRoles=["Admin","Moderator","Member"],this.selectedRoles=g([]),this.UpdatedUser=new $,this.show=e=>{this.User.set(e),e.roles!==void 0&&this.selectedRoles.set(e.roles),this.hideModal=!1},this.hide=()=>{this.hideModal=!0}}updateChecked(e){this.selectedRoles().includes(e)?this.selectedRoles.update(n=>n.filter(o=>o!==e)):this.selectedRoles.update(n=>[...n,e])}updateRoles(){this.hide(),this._AdminService.updateUserRoles(this.User().username,this.selectedRoles()).subscribe({next:e=>{this.User.update(n=>F(A({},n),{roles:e})),this.UpdatedUser.emit(this.User())}})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=c({type:t,selectors:[["app-role-modal"]],outputs:{UpdatedUser:"UpdatedUser"},standalone:!0,features:[f],decls:19,vars:2,consts:[[1,"overflow-y-auto","overflow-x-hidden","bg-black","bg-opacity-50","fixed","top-0","right-0","left-0","z-50","justify-center","items-center","w-full","h-screen"],[1,"relative","p-10","w-fit","mx-auto","max-w-2xl","max-h-full"],[1,"relative","bg-white","rounded-lg","shadow-sm","dark:bg-gray-700"],[1,"flex","items-center","justify-between","p-4","md:p-5","border-b","rounded-t","dark:border-gray-600","border-gray-200"],[1,"text-xl","font-semibold","text-gray-900","dark:text-white"],["type","button",1,"text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-900","rounded-lg","text-sm","w-8","h-8","ms-auto","inline-flex","justify-center","items-center",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 14",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"],[1,"sr-only"],[1,"p-4","md:p-5","space-y-4"],[1,"flex","gap-1","flex-wrap","items-center"],[1,"flex","items-center","p-4","md:p-5","border-t","border-gray-200","rounded-b"],["type","button",1,"text-white","bg-sky-600","hover:bg-sky-800","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center",3,"click"],["type","button",1,"py-2.5","px-5","ms-3","text-sm","font-medium","text-gray-900","bg-white","rounded-lg","border","border-gray-200","hover:bg-gray-100","hover:text-sky-700",3,"click"],["type","checkbox","value","role",1,"rounded","focus:outline-none","focus:ring-0",3,"change","id","checked","disabled"],[3,"for"]],template:function(n,o){n&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),s(5," Select Role/s "),i(),r(6,"button",5),d("click",function(){return o.hide()}),D(),r(7,"svg",6),p(8,"path",7),i(),V(),r(9,"span",8),s(10,"Close modal"),i()()(),r(11,"div",9),U(12,N,4,5,"div",10,P),i(),r(14,"div",11)(15,"button",12),d("click",function(){return o.updateRoles()}),s(16," Submit "),i(),r(17,"button",13),d("click",function(){return o.hide()}),s(18," Cancel "),i()()()()()),n&2&&(w("hidden",o.hideModal),a(12),k(o.availableRoles))}})}}return t})();var X=(t,m)=>m.username;function Y(t,m){if(t&1){let e=v();r(0,"tr",5)(1,"td",7),s(2),i(),r(3,"td",7),s(4),i(),r(5,"td",7)(6,"button",8),d("click",function(){let o=h(e).$implicit,l=u();return x(l.openModal(o))}),s(7," Edit Roles "),i()()()}if(t&2){let e=m.$implicit;a(2),y(e.username),a(2),y(e.roles)}}var O=(()=>{class t{constructor(){this._AdminService=_(S),this.Users=g([]),this.modal=new M}ngOnInit(){this.getUsersWithRoles()}getUpdatedUser(e){this.Users.update(n=>(n.map(o=>(o.username===e.username&&(o.roles=e.roles),o)),n))}openModal(e){this.modal.show(e)}getUsersWithRoles(){console.log("Getting users"),this._AdminService.getUsersWithRoles().subscribe({next:e=>{this.Users.set(e)}})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=c({type:t,selectors:[["app-user-management"]],viewQuery:function(n,o){if(n&1&&Q(M,5),n&2){let l;W(l=L())&&(o.modal=l.first)}},standalone:!0,features:[f],decls:12,vars:0,consts:[[1,"w-full","text-sm","text-center","text-sky-600"],[1,"text-xs","text-sky-700","uppercase","bg-sky-100"],[1,""],["scope","col",1,"px-6","py-3"],[1,"text-sm","text-gray-500","capitalize"],[1,"odd:bg-white","even:bg-sky-50","border-b"],[3,"UpdatedUser"],["scope","row",1,"px-6","py-4","font-medium","whitespace-nowrap"],[1,"rounded","px-4","py-2","outline","outline-1","hover:bg-sky-600","hover:text-white","bg-white","outline-sky-600","text-sky-500",3,"click"]],template:function(n,o){n&1&&(r(0,"table",0)(1,"thead",1)(2,"tr",2)(3,"th",3),s(4,"Username"),i(),r(5,"th",3),s(6,"Active Roles"),i(),p(7,"th",3),i()(),r(8,"tbody",4),U(9,Y,8,2,"tr",5,X),i()(),r(11,"app-role-modal",6),d("UpdatedUser",function(K){return o.getUpdatedUser(K)}),i()),n&2&&(a(9),k(o.Users()))},dependencies:[M]})}}return t})();var q=()=>["Admin"];function Z(t,m){if(t&1){let e=v();r(0,"li",6)(1,"button",7),d("click",function(){h(e);let o=u();return x(o.setActiveTab("user-management"))}),s(2," User management "),i()()}if(t&2){let e=u();a(),w("text-sky-600",e.activeTab==="user-management")("border-sky-600",e.activeTab==="user-management")}}function ee(t,m){t&1&&(r(0,"div",5),p(1,"app-user-management"),i())}function te(t,m){t&1&&C(0,ee,2,0,"div",8),t&2&&b("appHasRole",T(1,q))}var J=(()=>{class t{constructor(){this.activeTab="user-management"}setActiveTab(e){this.activeTab=e}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=c({type:t,selectors:[["app-tabs"]],standalone:!0,features:[f],decls:6,vars:3,consts:[[1,"border","border-sky-100","rounded-lg"],[1,"font-semibold","text-sm","text-gray-500"],[1,"flex","flex-wrap"],["class","mr-2",4,"appHasRole"],[1,"py-5"],[1,"relative","overflow-x-auto"],[1,"mr-2"],[1,"block","p-4","border-b-2",3,"click"],["class","relative overflow-x-auto",4,"appHasRole"]],template:function(n,o){n&1&&(r(0,"div",0)(1,"div",1)(2,"ul",2),C(3,Z,3,4,"li",3),i()(),r(4,"div",4),C(5,te,1,2,"div",5),i()()),n&2&&(a(3),b("appHasRole",T(2,q)),a(2),I(5,o.activeTab==="user-management"?5:-1))},dependencies:[O,G]})}}return t})();var Ce=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=c({type:t,selectors:[["app-admin-panel"]],standalone:!0,features:[f],decls:4,vars:0,consts:[[1,"p-10"],[1,"text-3xl","text-gray-600","font-semibold","mb-2"]],template:function(n,o){n&1&&(r(0,"div",0)(1,"h1",1),s(2,"Admin panel"),i(),p(3,"app-tabs"),i())},dependencies:[J]})}}return t})();export{Ce as AdminPanelComponent};
