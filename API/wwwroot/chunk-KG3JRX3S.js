import{a as $}from"./chunk-T5J757QH.js";import{a as W,d as j,e as L,g as z,h as G,i as J,q as K,s as X}from"./chunk-T4MTWN4K.js";import{a as Y,b as Z}from"./chunk-N64AD6VI.js";import{c as q,f as H}from"./chunk-I5PP4UYU.js";import"./chunk-L3R4MWKK.js";import"./chunk-XAZLOLJU.js";import{$a as R,Ca as d,Da as T,Fa as N,Ga as k,Ha as s,Ia as a,Ja as M,N as c,Na as U,P as y,Pa as O,Qa as b,Rb as Q,W as u,Wa as v,X as f,Xa as _,Ya as C,Za as F,_a as l,ab as g,cb as V,db as E,eb as A,gb as D,ja as S,kb as P,la as r,lb as B,sb as I,va as h,xa as w,za as x}from"./chunk-R4PBEABJ.js";import"./chunk-5WK33CEB.js";var te=["messageForm"],ie=["scrollMe"],re=(t,m)=>m.id;function se(t,m){t&1&&(s(0,"p",3),l(1,"Say Hi!\u{1F44B}"),a())}function ne(t,m){if(t&1&&(s(0,"div")(1,"div")(2,"div",9)(3,"div",10),M(4,"img",11),s(5,"span",12),l(6),a()(),s(7,"span",13),M(8,"i",14),l(9),P(10,"timeago"),a()(),s(11,"div",15)(12,"div",16)(13,"p",17),l(14),a()(),s(15,"p"),l(16),a()()()()),t&2){let e=m.$implicit,i=b(2);d("flex items-start gap-2.5"+(e.senderUserName==i.OtherUserName()?"transform scale-x-[-1]":"")),r(),d(e.senderUserName==i.OtherUserName()?"transform scale-x-[-1]":""),r(3),x("src",e.senderPhotoURL,S),r(2),R(e.senderUserName),r(3),g(" ",B(10,11,e.messageSent)," "),r(5),g(" ",e.content," "),r(),d((e.dateRead?"text-green-400":"text-sky-500")+" text-sm font-normal m-0 text-end"),r(),g(" ",e.dateRead?"Read":"Unread"," ")}}function oe(t,m){if(t&1&&N(0,ne,17,13,"div",8,re),t&2){let e=b();k(e.MessageThread())}}var be=(()=>{class t{constructor(){this._MessageService=c($),this._ActivatedRoute=c(Q),this._AccountService=c(H),this.OtherUserName=h(""),this.MessageThread=I(()=>this._MessageService.MessageThread()),this.MessageContent=h(""),this._ToastrService=c(q)}ngOnInit(){this._ActivatedRoute.parent?.paramMap.subscribe({next:e=>{let i=e.get("memberName");i&&(this.OtherUserName.set(i),this.loadThreadMessage())}})}sendMessage(){this._MessageService.sendMessage(this.OtherUserName(),this.MessageContent()).then(()=>{this.messageForm?.reset(),this.scrollToBottom()})}ngAfterViewInit(){setTimeout(()=>{this.scrollToBottom()},500)}scrollToBottom(){this.scrollContainer&&(console.log("scroll to bottom............"),this.scrollContainer.nativeElement.scrollTop=this.scrollContainer.nativeElement.scrollHeight)}loadThreadMessage(){let e=this._AccountService.CurrentUser();e&&this._MessageService.createHubConnection(e,this.OtherUserName())}ngOnDestroy(){this._MessageService.stopHubConnection()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=y({type:t,selectors:[["app-messages"]],viewQuery:function(i,o){if(i&1&&(v(te,5),v(ie,5)),i&2){let n;_(n=C())&&(o.messageForm=n.first),_(n=C())&&(o.scrollContainer=n.first)}},standalone:!0,features:[D],decls:10,vars:3,consts:[["scrollMe",""],["messageForm","ngForm"],[1,"container","w-3/4","mx-auto","rounded-xl","bg-white","p-10",2,"overflow","scroll","max-height","500px","scroll-behavior","smooth"],[1,"text-gray-400","text-2xl","text-start"],[3,"ngSubmit"],[1,"my-5"],["type","text","required","","name","messageContent","placeholder","Send a private message...",1,"w-full","focus:ring-0","focus:border-sky-500","text-gray-500","border-gray-200","py-2","px-4","rounded",3,"ngModelChange","ngModel"],[1,"rounded","disabled:bg-gray-400","block","ms-auto","my-2","bg-sky-500","hover:bg-sky-700","px-4","py-2","text-white","font-semibold","text-sm",3,"disabled"],[3,"class"],[1,"flex","justify-between","items-center","mb-2"],[1,"flex","items-center","gap-2"],["alt","Jese image",1,"w-8","h-8","rounded-full",3,"src"],[1,"text-sm","font-semibold","text-gray-900"],[1,"text-sm","font-normal","text-gray-500"],[1,"fa-regular","text-gray-600","fa-clock"],[1,"flex","flex-col","gap-1","w-full","max-w-[320px]"],[1,"flex","flex-col","leading-1.5","p-4","border-gray-200","bg-gray-100","rounded-e-xl","rounded-es-xl"],[1,"text-sm","font-normal","text-gray-900"]],template:function(i,o){if(i&1){let n=U();s(0,"section",2,0),w(2,se,2,0,"p",3)(3,oe,2,0),s(4,"form",4,1),O("ngSubmit",function(){return u(n),f(o.sendMessage())}),s(6,"div",5)(7,"input",6),A("ngModelChange",function(p){return u(n),E(o.MessageContent,p)||(o.MessageContent=p),f(p)}),a(),s(8,"button",7),l(9," Send "),a()()()()}if(i&2){let n=F(5);r(2),T(2,o.MessageThread().length==0?2:3),r(5),V("ngModel",o.MessageContent),r(),x("disabled",n.invalid)}},dependencies:[Z,Y,X,J,W,j,L,K,G,z],styles:["[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}"]})}}return t})();export{be as MemberMessagesComponent};
